<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <br>
    <br>
    Tanque
    <input type="checkbox" id="check_Tanque" onclick="contadorChecks()">
    <br>
    Dano
    <input type="checkbox" id="check_Dano" onclick="contadorChecks()">
    <br>
    Suporte
    <input type="checkbox" id="check_Suporte" onclick="contadorChecks()">
    <br>
    Todos
    <input type="checkbox" id="check_Todos" onclick="contadorChecks()">

    <button onclick="guardarRoles()">Pronto</button>

</body>

</html>

<script>

    const listaFuncao = [];

    function contadorChecks() {

        let qtdChecked = 0;

        if (check_Tanque.checked) {

            qtdChecked++

        }

        if (check_Dano.checked) {

            qtdChecked++

        }

        if (check_Suporte.checked) {

            qtdChecked++

        }

        if (qtdChecked == 2) {

            check_Todos.disabled = true;

            if (!check_Tanque.checked) {

                check_Tanque.disabled = true;

            }

            if (!check_Dano.checked) {

                check_Dano.disabled = true;

            }

            if (!check_Suporte.checked) {

                check_Suporte.disabled = true;

            }

        } else if (check_Todos.checked) {

            check_Tanque.disabled = true;
            check_Dano.disabled = true;
            check_Suporte.disabled = true;

            check_Tanque.checked = false;
            check_Dano.checked = false;
            check_Suporte.checked = false;

        } else {

            check_Tanque.disabled = false;
            check_Dano.disabled = false;
            check_Suporte.disabled = false;
            check_Todos.disabled = false;

        }

    }

    function guardarRoles() {

        if (check_Tanque.checked) {

            listaFuncao.push('Tanque');

        }

        if (check_Dano.checked) {

            listaFuncao.push('Dano');

        }

        if (check_Suporte.checked) {

            listaFuncao.push('Suporte');

        }

        if (check_Todos.checked) {

            listaFuncao.push('Todos');

        }

        guardarBanco();

    }

    function guardarBanco() {

        // v nome do arquivo, depois da função que quer chamar
        fetch("/funcao/cadastrarFuncao", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                funcaoServer: listaFuncao
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    setTimeout(() => {
                        window.location = "cadastroPersonagens.html";
                    }, "2000");

                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
    }

</script>